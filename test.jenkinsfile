properties([
    parameters([[$class: 'ChoiceParameter', choiceType: 'PT_CHECKBOX', filterLength: 1, filterable: false, name: 'REPO_LIST', randomName: 'choice-parameter-1431964056666', script: [$class: 'GroovyScript', fallbackScript: [classpath: [], oldScript: '', sandbox: false, script: ''], script: [classpath: [], oldScript: '', sandbox: false, 
                script: '''
                    // def apiEndpoint = "https://api.github.com/gonelayamuna/repos"
                    // Fetch Git repositories dynamically (GitHub example)
                    def gitHubUser = 'gonelayamuna'
                    def apiEndpoint = "https://api.github.com/users/gonelayamuna/repos"
                    def repos = ['YAMUNA','DEVI','GONELA', 'DHANYA']
                    
                    try {
                        def response = httpRequest(url: apiEndpoint, httpMode: 'GET', authentication: 'gonelayamuna')
                        def json = readJSON text: response.content
                        json.each { repo ->
                            repos << repo.name
                        }
                    } catch (Exception e) {
                        echo "Error fetching repositories: ${e.message}"
                    }
                    
                    return repos
                   '''
                ]]]])])

pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                script {
                    // Use the selected repositories in your build steps
                    def selectedRepos = params.REPO_LIST
                    echo "Selected repositories: ${selectedRepos}"
                    
                    // Your build steps go here
                }
            }
        }
    }
}
